{"version":3,"sources":["webpack://today-i-learned-api/./src/app.js","webpack://today-i-learned-api/./src/commons/http-handler.js","webpack://today-i-learned-api/./src/commons/logger.js","webpack://today-i-learned-api/./src/index.js","webpack://today-i-learned-api/./src/modules/db/index.js","webpack://today-i-learned-api/./src/modules/index.js","webpack://today-i-learned-api/./src/modules/posts/index.js","webpack://today-i-learned-api/./src/modules/posts/models/blog-post-model.js","webpack://today-i-learned-api/./src/modules/posts/models/index.js","webpack://today-i-learned-api/./src/modules/posts/router/index.js","webpack://today-i-learned-api/./src/modules/posts/service/index.js","webpack://today-i-learned-api/./src/modules/posts/service/parsing-file.js","webpack://today-i-learned-api/external \"assert\"","webpack://today-i-learned-api/external \"babel-polyfill\"","webpack://today-i-learned-api/external \"cookie-parser\"","webpack://today-i-learned-api/external \"cors\"","webpack://today-i-learned-api/external \"express\"","webpack://today-i-learned-api/external \"express-fileupload\"","webpack://today-i-learned-api/external \"express-pino-logger\"","webpack://today-i-learned-api/external \"fastest-validator\"","webpack://today-i-learned-api/external \"helmet\"","webpack://today-i-learned-api/external \"http-errors-lite\"","webpack://today-i-learned-api/external \"http-status-codes\"","webpack://today-i-learned-api/external \"mongoose\"","webpack://today-i-learned-api/external \"pino\"","webpack://today-i-learned-api/webpack/bootstrap","webpack://today-i-learned-api/webpack/runtime/compat get default export","webpack://today-i-learned-api/webpack/runtime/define property getters","webpack://today-i-learned-api/webpack/runtime/hasOwnProperty shorthand","webpack://today-i-learned-api/webpack/runtime/make namespace object","webpack://today-i-learned-api/webpack/startup"],"names":["logger","getLogger","getAnApp","app","Express","use","cors","origin","process","credentials","helmet","cookieParser","expressFileUpload","createParentPath","expressPinoLogger","serializers","req","method","url","body","res","statusCode","raw","notFoundHandler","next","createError","StatusCodes","isGoodError","error","errorHandler","_next","message","stack","some","x","status","send","finishApp","expressApp","httpHandler","asyncFn","err","source","pino","level","prettyPrint","colorize","translateTime","ignore","child","name","get","loadModules","listen","Number","info","exit","mongoose","useNewUrlParser","useCreateIndex","useFindAndModify","useUnifiedTopology","modules","PostsModule","p","map","init","Promise","all","router","Router","tilRouter","schema","author","type","String","trim","title","date","Date","content","tags","timestamps","PostsDBModule","posts","postModel","FILE_KEY","post","file","files","markdownParser","data","blogJson","postsService","query","results","tag","params","recordId","record_id","result","put","id","service","addRecord","fetchRecords","r","length","assert","updateRecord","_id","fetchByTag","getRecord","deleteRecord","buffer","toString","lines","split","reduce","acc","curr","i","temp","blog","test","indexStart","indexEnd","key","value","filter","join"],"mappings":"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","file":"index.js","sourcesContent":["import Express from 'express';\nimport expressPinoLogger from 'express-pino-logger';\nimport helmet from 'helmet';\nimport cors from 'cors';\nimport cookieParser from 'cookie-parser';\nimport 'fastest-validator';\nimport expressFileUpload from 'express-fileupload';\n\nimport { StatusCodes } from 'http-status-codes';\nimport createError from 'http-errors-lite';\nimport { getLogger } from '@commons/logger';\n\nconst logger = getLogger('app.js');\n\nexport const getAnApp = () => {\n  const app = Express();\n  app.use(\n    cors({\n      origin: process.env.FRONTEND_URL,\n      credentials: true,\n    })\n  );\n\n  app.use(helmet());\n  app.use(cookieParser());\n\n  app.use(\n    expressFileUpload({\n      createParentPath: true,\n    })\n  );\n\n  if (process.env.NODE_ENV !== 'test')\n    app.use(\n      expressPinoLogger({\n        logger,\n        serializers: {\n          req: (req) => ({\n            method: req.method,\n            url: req.url,\n            body: req.body,\n          }),\n          res: (res) => ({\n            statusCode: res.statusCode,\n            body: res.raw.body,\n          }),\n        },\n      })\n    );\n\n  app.use(Express.json());\n  return app;\n};\n\nconst notFoundHandler = (req, res, next) => {\n  next(createError(StatusCodes.NOT_FOUND, 'Not Found'));\n};\n\nconst isGoodError = (error) => error.statusCode <= 404;\n\nconst errorHandler = (error, req, res, _next) => {\n  if (process.env.NODE_ENV !== 'test') {\n    logger.error(`${error.statusCode} 💥 ${error.message}`);\n    logger.error(error.stack);\n  }\n\n  if (['development', 'test'].some((x) => x === process.env.NODE_ENV)) {\n    res.status(error.statusCode || 500);\n    res.send({ error: error.message });\n  } else {\n    res.status(isGoodError(error) ? error.statusCode : 500);\n    res.send({\n      error: isGoodError(error) ? error.message : 'SOMETHING WENT WRONG',\n    });\n  }\n};\n\nexport const finishApp = (expressApp) => {\n  expressApp.use(notFoundHandler);\n  expressApp.use(errorHandler);\n};\n","export const httpHandler = (asyncFn) => {\n  return (req, res, next) => {\n    asyncFn(req, res, next).catch((err) => {\n      next(err);\n    });\n  };\n};\n","import pino from 'pino';\n\nexport const getLogger = (source) => {\n    const logger = pino({\n        level: 'debug',\n        prettyPrint: {\n            colorize: true,\n            // levelFirst: true,\n            translateTime: 'SYS:HH:MM:ss dd-mm-yyyy',\n            ignore: 'pid,hostname',\n        },\n    });\n    return logger.child({ name: source })\n};\n","import { StatusCodes } from 'http-status-codes';\nimport { finishApp, getAnApp } from '@app';\nimport { getLogger } from '@commons/logger';\nimport { loadModules } from './modules';\n\nconst logger = getLogger('src/index.js');\n\nconst app = getAnApp();\n\napp.get('/healthy', (req, res) => {\n  res.send(StatusCodes.OK);\n});\n\n(async () => {\n  await loadModules(app);\n  finishApp(app);\n})();\n\n(async () => {\n  try {\n    await app.listen(Number(process.env.PORT));\n    logger.info(`API Server started @ ${process.env.PORT}`);\n  } catch (err) {\n    logger.error(err);\n    process.exit(1);\n  }\n})();\n","import { getLogger } from '@commons/logger';\nimport mongoose from 'mongoose';\n\nconst logger = getLogger('db/index');\n(async () => {\n  try {\n    await mongoose.connect(process.env.DB_URL, {\n      useNewUrlParser: true,\n      useCreateIndex: true,\n      useFindAndModify: false,\n      useUnifiedTopology: true,\n    });\n    logger.info(\n      `Successfully connected to Mongo running @ ${process.env.DB_URL}`\n    );\n  } catch (arr) {\n    logger.error(`Failed connecting to mongo runnning @ ${process.env.DB_URL}`);\n  }\n})();\n","import './db';\nimport { PostsModule } from './posts';\n\nconst modules = [PostsModule];\n\nexport async function loadModules(expressApp) {\n  const p = modules.map(({ init }) => init(expressApp));\n  return Promise.all(p);\n}\n","import { Router } from 'express';\nimport { tilRouter } from './router';\n\nconst router = Router();\nrouter.use('/til', tilRouter);\n\nexport const PostsModule = {\n  init: async (app) => app.use(router),\n};\n","import mongoose from 'mongoose';\n\nconst schema = new mongoose.Schema(\n  {\n    author: {\n      type: String,\n      trim: true,\n    },\n    title: {\n      type: String,\n      trim: true,\n    },\n    date: {\n      type: Date,\n      trim: true,\n    },\n    content: {\n      type: String,\n      trim: true,\n    },\n    tags: [{ type: String, trim: true }],\n  },\n  { timestamps: true }\n);\n\nexport default mongoose.model('post', schema);\n","import postModel from './blog-post-model';\n\nexport const PostsDBModule = {\n  posts: postModel,\n};\n","import { httpHandler } from '@commons/http-handler';\nimport { Router } from 'express';\nimport createError from 'http-errors-lite';\nimport { StatusCodes } from 'http-status-codes';\nimport { postsService } from '../service';\nimport { markdownParser } from '../service/parsing-file';\n\nexport const tilRouter = Router();\n\nconst FILE_KEY = 'blog-post';\n\ntilRouter.post(\n  '/upload',\n  httpHandler(async (req, res) => {\n    const file = req.files[FILE_KEY];\n    if (!file) {\n      throw createError(\n        StatusCodes.BAD_REQUEST,\n        'No File Uploaded with correct field'\n      );\n    }\n    res.send('File Uploaded');\n\n    const blogJson = await markdownParser(file.data);\n    await postsService.addRecord(blogJson);\n  })\n);\n\ntilRouter.get(\n  '/',\n  httpHandler(async (req, res) => {\n    const { query } = req.query;\n    const results = await postsService.fetchRecords(query);\n    res.send(results);\n  })\n);\n\ntilRouter.get(\n  '/tags/:tag',\n  httpHandler(async (req, res) => {\n    const { tag } = req.params;\n    const results = await postsService.fetchByTag(tag);\n    res.send(results);\n  })\n);\n\ntilRouter.get(\n  '/id/:record_id',\n  httpHandler(async (req, res) => {\n    const { record_id: recordId } = req.params;\n    const result = await postsService.getRecord(recordId);\n    res.send(result);\n  })\n);\n\ntilRouter.put(\n  '/id/:record_id',\n  httpHandler(async (req, res) => {\n    const { record_id: recordId } = req.params;\n    const file = req.files[FILE_KEY];\n    const blogJson = await markdownParser(file.data);\n    const result = await postsService.updateRecord({\n      id: recordId,\n      data: blogJson,\n    });\n    res.send(result);\n  })\n);\n\ntilRouter.delete(\n  '/id/:record_id',\n  httpHandler(async (req, res) => {\n    const { record_id: recordId } = req.params;\n    await postsService.deleteRecord(recordId);\n    res.send(StatusCodes.OK);\n  })\n);\n","import assert from 'assert';\nimport { PostsDBModule } from '../models';\n\nconst service = {};\n\nservice.addRecord = async (data) => {\n  if ('date' in data) {\n    const r = await service.fetchRecords({ date: data.date });\n    if (r.length > 0) {\n      assert(r.length === 0);\n      return service.updateRecord({ id: r._id, data });\n    }\n  }\n  return PostsDBModule.posts.create(data);\n};\n\nservice.fetchRecords = async (query = {}) => PostsDBModule.posts.find(query);\n\nservice.fetchByTag = async (tag) => PostsDBModule.posts.find({ tags: tag });\n\nservice.getRecord = async (id) => PostsDBModule.posts.findById(id);\n\nservice.updateRecord = async ({ id, data }) =>\n  PostsDBModule.posts.findOneAndUpdate({ _id: id }, data, { new: true });\n\nservice.deleteRecord = async (id) => PostsDBModule.posts.deleteOne({ _id: id });\n\nexport const postsService = service;\n","/* eslint-disable no-restricted-syntax */\n\nimport { getLogger } from '@commons/logger';\n\nconst logger = getLogger('parsing-file.js');\n\nexport async function markdownParser(buffer) {\n  const content = buffer.toString();\n  const lines = content.split('\\n');\n\n  let indexStart;\n  let indexEnd;\n  const data = lines.reduce(\n    (acc, curr, i) => {\n      const temp = {};\n      let blog = '';\n      if (/^---$/.test(curr)) {\n        if (indexStart == null) {\n          indexStart = i;\n        } else if (!indexEnd) {\n          indexEnd = i;\n        }\n      }\n      if (indexStart != null && i > indexStart && (!indexEnd || i < indexEnd)) {\n        const [key, value] = lines[i].split(':', 2);\n        temp[key] = value.trim();\n      }\n\n      if (indexEnd && i > indexEnd) {\n        blog = lines[i];\n      }\n      return { ...acc, ...temp, content: [...acc.content, blog] };\n    },\n    { content: [] }\n  );\n\n  data.tags = 'tags' in data ? data.tags.split(',') : [];\n  data.content =\n    'content' in data ? data.content.filter((x) => x).join('\\n') : '';\n  logger.info('Parsed Document: ', data);\n  return data;\n}\n","module.exports = require(\"assert\");;","module.exports = require(\"babel-polyfill\");;","module.exports = require(\"cookie-parser\");;","module.exports = require(\"cors\");;","module.exports = require(\"express\");;","module.exports = require(\"express-fileupload\");;","module.exports = require(\"express-pino-logger\");;","module.exports = require(\"fastest-validator\");;","module.exports = require(\"helmet\");;","module.exports = require(\"http-errors-lite\");;","module.exports = require(\"http-status-codes\");;","module.exports = require(\"mongoose\");;","module.exports = require(\"pino\");;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => module['default'] :\n\t\t() => module;\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop)","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// startup\n// Load entry module\n__webpack_require__(\"babel-polyfill\");\n// This entry module used 'module' so it can't be inlined\n__webpack_require__(\"./index.js\");\n"],"sourceRoot":""}